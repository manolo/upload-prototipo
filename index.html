
<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="../webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="../polymer/polymer.html">
  <link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
  <link rel="import" href="vaadin-upload.html">
  <style>
    body {
      font-family: Arial;
    }
    .button {
       color: #1DB6E4;
       font-size: 95%;
       font-weight: bold;
    }
    .drop {
      font-size: 130%;
    }
    .button, .drop {
       display: inline-block;
       text-align: center;
    }
    .button2 {
      position: absolute;
      background: #1DB6E4;
      color: white;
      padding-left: 10px;
      padding-right: 10px;
      margin-left: -55px;
    }
    vaadin-upload {
      margin: 10px;
    }
  </style>
</head>
<body>
<!-- http://manolo-demo:8080/upload/servlet.gupld  -->
<!-- http://gwtupload.alcala.org/gupld/servlet.gupld -->
<vaadin-upload id="u1"
   target="http://manolo-demo:8080/upload/servlet.gupld" method="POST"
   droppable="true" multi="true" accept="image/*"
   headers='{"Accepddt":"application/json"}'
   max-file-size="0"
   >

  <div class="button">
    ADD FILE(S)
  </div>
  <div class="drop">
    <iron-icon icon="cloud-upload"></iron-icon>
    Drop files here ...
  </div>

</vaadin-upload>

<vaadin-upload id="u1"
   target="http://manolo-demo:8080/upload/servlet.gupld" method="POST"
   droppable="true" multi="true" accept="image/*">

  <div class="button button2">
    ADD FILE(S)
  </div>
  <div class="drop">
    <iron-icon icon="cloud-upload"></iron-icon>
    Drop files here ...
  </div>

</vaadin-upload>


<script type="text/javascript">
  HTMLImports.whenReady(function() {
    document.querySelector('#u1').addEventListener('upload-success', function(e){
      console.log("success", e.detail.xhr);
    })
    document.querySelector('#u1').addEventListener('upload-error', function(e){
      console.log("error", e.detail.xhr);
    })
    document.querySelector('#u1').errorHandler = function(file, xhr) {
      try {
        var json = JSON.parse(xhr.responseText);
        if (!json.error) return json.error
      } catch (e) {
        return "Unknown server response. " + xhr.responseText.substr(0, 20);
      }
    }
  });
</script>
</body>
</html>
